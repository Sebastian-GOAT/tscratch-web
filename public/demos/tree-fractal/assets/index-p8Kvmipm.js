(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();var i=document.getElementById("game-window"),h=i.getContext("2d"),f=document.createElement("canvas"),c=f.getContext("2d");f.id="pen-canvas";var w=16/9,d;function z(t){d=t,i.width=w*d,i.height=d,f.width=w*d,f.height=d}i.parentElement?.insertBefore(f,i);z(500);var S=class{x;y;dir;scene;hidden;layer;refresh(){g.init().refresh()}constructor(t){this.x=t?.x??0,this.y=t?.y??0,this.dir=t?.dir??0,this.scene=t?.scene??"main",this.hidden=t?.hidden??!1,this.layer=t?.layer??0,g.init().addSprite(this)}toRadians(t){return t*Math.PI/180}toDegrees(t){return t*180/Math.PI}move(t){this.x+=t*Math.sin(this.toRadians(this.dir)),this.y+=t*Math.cos(this.toRadians(this.dir)),this.refresh()}turn(t){this.dir+=t,this.refresh()}point(t){this.dir=t,this.refresh()}setX(t){this.x=t,this.refresh()}setY(t){this.y=t,this.refresh()}goTo(t,e){this.x=t,this.y=e,this.refresh()}changeX(t){this.x+=t,this.refresh()}changeY(t){this.y+=t,this.refresh()}show(){this.hidden=!1,this.refresh()}hide(){this.hidden=!0,this.refresh()}goToLayer(t){this.layer=t,this.refresh()}changeLayer(t){this.layer+=t,this.refresh()}},g=class v{static instance;loopRunning=!1;gameLoop=null;maxFPS=24;mouseX=0;mouseY=0;mouseDown=!1;currentScene="main";sceneMap={};static init(){return this.instance||(this.instance=new v),this.instance}changeScene(e){this.sceneMap[e]||(this.sceneMap[e]={sprites:[],loop:null}),this.loopRunning=!1,this.currentScene=e,this.gameLoop=this.sceneMap[e].loop,this.setMaxFramesPerSecond(this.maxFPS)}setLoop(e,s){if(!this.sceneMap[e]){this.sceneMap[e]={sprites:[],loop:s},e===this.currentScene&&this.changeScene(e);return}this.sceneMap[e].loop=s,e===this.currentScene&&this.changeScene(e)}addSprite(e){let{scene:s,layer:a}=e;if(!this.sceneMap[s]){this.sceneMap[s]={sprites:[e],loop:null};return}let n=this.sceneMap[s].sprites.findIndex(r=>r.layer>a);if(n===-1){this.sceneMap[s].sprites.push(e);return}this.sceneMap[s].sprites.splice(n,0,e)}async setMaxFramesPerSecond(e){this.maxFPS=e;let s=this.gameLoop;if(s)for(this.loopRunning=!0;this.loopRunning;)await s(),await this.wait(1e3/e)}refresh(){h.clearRect(0,0,i.width,i.height),this.sceneMap[this.currentScene]?.sprites.forEach(e=>{e.hidden||e.draw()})}async wait(e){return new Promise(s=>setTimeout(s,e))}isHovered(e){let{mouseX:s,mouseY:a}=this,n=s+i.width/2,r=i.height/2-a,l=n-(e.x+i.width/2),m=r-(i.height/2-e.y),u=-this.toRadians(e.dir),R=l*Math.cos(u)-m*Math.sin(u),L=l*Math.sin(u)+m*Math.cos(u);return h.isPointInPath(e.getPath(),R,L)}pickRandom(e,s){return e>s&&([e,s]=[s,e]),Math.floor(Math.random()*(s-e+1)+e)}sin(e){return Math.sin(this.toRadians(e))}cos(e){return Math.cos(this.toRadians(e))}tan(e){return Math.tan(this.toRadians(e))}csc(e){return 1/Math.sin(this.toRadians(e))}sec(e){return 1/Math.cos(this.toRadians(e))}cot(e){return 1/Math.tan(this.toRadians(e))}asin(e){return this.toDegrees(Math.asin(e))}acos(e){return this.toDegrees(Math.acos(e))}acsc(e){return this.toDegrees(Math.asin(1/e))}asec(e){return this.toDegrees(Math.acos(1/e))}toRadians(e){return e*Math.PI/180}toDegrees(e){return e*180/Math.PI}constructor(){this.setMaxFramesPerSecond(24),i.addEventListener("mousemove",e=>{this.mouseX=e.clientX-i.offsetLeft-i.width/2,this.mouseY=-(e.clientY-i.offsetTop-i.height/2)}),i.addEventListener("mousedown",e=>{this.mouseDown=!0}),i.addEventListener("mouseup",e=>{this.mouseDown=!1})}},F=class extends S{drawing;size;color;getPath(){return new Path2D}draw(){}up(){this.drawing=!1}down(){this.drawing=!0}ereaseAll(){c.clearRect(0,0,i.width,i.height)}dot(){c.fillStyle=this.color,c.fillRect(this.x-this.size/2+i.width/2,-this.y-this.size/2+i.height/2,this.size,this.size)}drawLine(t,e){c.beginPath(),c.moveTo(t+i.width/2,-e+i.height/2),c.lineTo(this.x+i.width/2,-this.y+i.height/2),c.lineWidth=this.size,c.strokeStyle=this.color,c.stroke()}move(t){let e=this.x,s=this.y;this.x+=t*Math.sin(this.toRadians(this.dir)),this.y+=t*Math.cos(this.toRadians(this.dir)),this.drawing&&this.drawLine(e,s),this.refresh()}setX(t){let e=this.x,s=this.y;this.x=t,this.drawing&&this.drawLine(e,s),this.refresh()}setY(t){let e=this.x,s=this.y;this.y=t,this.drawing&&this.drawLine(e,s),this.refresh()}goTo(t,e){let s=this.x,a=this.y;this.x=t,this.y=e,this.drawing&&this.drawLine(s,a),this.refresh()}changeX(t){let e=this.x,s=this.y;this.x+=t,this.drawing&&this.drawLine(e,s),this.refresh()}changeY(t){let e=this.x,s=this.y;this.y+=t,this.drawing&&this.drawLine(e,s),this.refresh()}constructor(t){super(t),this.drawing=t?.drawing??!1,this.size=t?.size??5,this.color=t?.color??"black"}},D=class extends S{content;color;fontFamily;fontSize;align;baseline;font;getPath(){let t=new Path2D;h.save(),h.font=this.font;let e=h.measureText(this.content),s=e.width,a=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return h.restore(),t.rect(-s/2,-a/2,s,a),t}draw(){h.save();let t=this.x+i.width/2,e=-this.y+i.height/2;h.translate(t,e),h.rotate(this.toRadians(this.dir)),h.font=this.font,h.fillStyle=this.color,h.textAlign=this.align,h.textBaseline=this.baseline,h.fillText(this.content,0,0),h.restore()}setContent(t){this.content=t,this.refresh()}setColor(t){this.color=t,this.refresh()}setFontSize(t){this.fontSize=t,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setFontFamily(t){this.fontFamily=t,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setAlign(t){this.align=t,this.refresh()}setBaseline(t){this.baseline=t,this.refresh()}constructor(t){super(t),this.content=t?.content??"",this.color=t?.color??"black",this.fontFamily=t?.fontFamily??"Arial",this.fontSize=t?.fontSize??16,this.align=t?.align??"center",this.baseline=t?.baseline??"middle",this.font=`${this.fontSize}px ${this.fontFamily}`}};const y=g.init(),P=80,b=9,x=0,M=45,T=.8,o=new F({size:4,y:-i.height/2+P});new D({content:"Made with TScratch",x:-i.width/2+5,y:i.height/2-5,align:"left",baseline:"top"});p(0,P);async function p(t,e){if(t>b)return;o.down(),o.move(e),o.up();const s=o.x,a=o.y,n=o.dir,r=e*T;o.turn(-M/2),await y.wait(x),await p(t+1,r),o.goTo(s,a),o.point(n),o.turn(M/2),await y.wait(x),await p(t+1,r)}
