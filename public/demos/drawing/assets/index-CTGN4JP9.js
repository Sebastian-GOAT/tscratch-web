(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&h(d)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function h(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();var i=document.getElementById("game-window"),l=i.getContext("2d"),o=document.createElement("canvas"),a=o.getContext("2d");o.id="pen-canvas";var M=16/9,c;function b(t){c=t,i.width=M*c,i.height=c,o.width=M*c,o.height=c}i.parentElement?.insertBefore(o,i);b(500);var y=class{x;y;dir;scene;hidden;layer;refresh(){m.init().refresh()}constructor(t){this.x=t?.x??0,this.y=t?.y??0,this.dir=t?.dir??0,this.scene=t?.scene??"main",this.hidden=t?.hidden??!1,this.layer=t?.layer??0,m.init().addSprite(this)}toRadians(t){return t*Math.PI/180}toDegrees(t){return t*180/Math.PI}move(t){this.x+=t*Math.sin(this.toRadians(this.dir)),this.y+=t*Math.cos(this.toRadians(this.dir)),this.refresh()}turn(t){this.dir+=t,this.refresh()}point(t){this.dir=t,this.refresh()}setX(t){this.x=t,this.refresh()}setY(t){this.y=t,this.refresh()}goTo(t,e){this.x=t,this.y=e,this.refresh()}changeX(t){this.x+=t,this.refresh()}changeY(t){this.y+=t,this.refresh()}show(){this.hidden=!1,this.refresh()}hide(){this.hidden=!0,this.refresh()}goToLayer(t){this.layer=t,this.refresh()}changeLayer(t){this.layer+=t,this.refresh()}},m=class P{static instance;loopRunning=!1;gameLoop=null;maxFPS=24;sounds=[];mouseX=0;mouseY=0;mouseDown=!1;mouseClicked=!1;keysPressed=new Set;currentScene="main";sceneMap={};static init(){return this.instance||(this.instance=new P),this.instance}changeScene(e){this.sceneMap[e]||(this.sceneMap[e]={sprites:[],loop:null}),this.loopRunning=!1,this.currentScene=e,this.gameLoop=this.sceneMap[e].loop,this.setMaxFramesPerSecond(this.maxFPS)}setLoop(e,s){if(!this.sceneMap[e]){this.sceneMap[e]={sprites:[],loop:s},e===this.currentScene&&this.changeScene(e);return}this.sceneMap[e].loop=s,e===this.currentScene&&this.changeScene(e)}addSprite(e){let{scene:s,layer:h}=e;if(!this.sceneMap[s]){this.sceneMap[s]={sprites:[e],loop:null};return}let r=this.sceneMap[s].sprites.findIndex(n=>n.layer>h);if(r===-1){this.sceneMap[s].sprites.push(e);return}this.sceneMap[s].sprites.splice(r,0,e),this.refresh()}removeSprite(e){let{scene:s}=e;this.sceneMap[s]&&(this.sceneMap[s].sprites=this.sceneMap[s].sprites.filter(h=>h!==e),this.refresh())}async setMaxFramesPerSecond(e){this.maxFPS=e;let s=this.gameLoop;if(s)for(this.loopRunning=!0;this.loopRunning;)await s(),await this.wait(1e3/e)}refresh(){l.clearRect(0,0,i.width,i.height),this.sceneMap[this.currentScene]?.sprites.forEach(e=>{e.hidden||e.draw()})}async wait(e){return new Promise(s=>setTimeout(s,e))}isHovered(e){let{mouseX:s,mouseY:h}=this,r=s+i.width/2,n=i.height/2-h,d=r-(e.x+i.width/2),x=n-(i.height/2-e.y),u=-this.toRadians(e.dir),R=d*Math.cos(u)-x*Math.sin(u),L=d*Math.sin(u)+x*Math.cos(u);return l.isPointInPath(e.getPath(),R,L)}isKeyPressed(e){return this.keysPressed.has(e)}playSound(e){let s=new Audio(e);return this.sounds.push(s),s.play(),s}stopSound(e){e.pause(),e.currentTime=0,this.sounds=this.sounds.filter(s=>s!==e)}stopAllSounds(){this.sounds.forEach(e=>{e.pause(),e.currentTime=0}),this.sounds=[]}pickRandom(e,s){return e>s&&([e,s]=[s,e]),Math.floor(Math.random()*(s-e+1)+e)}sin(e){return Math.sin(this.toRadians(e))}cos(e){return Math.cos(this.toRadians(e))}tan(e){return Math.tan(this.toRadians(e))}csc(e){return 1/Math.sin(this.toRadians(e))}sec(e){return 1/Math.cos(this.toRadians(e))}cot(e){return 1/Math.tan(this.toRadians(e))}asin(e){return this.toDegrees(Math.asin(e))}acos(e){return this.toDegrees(Math.acos(e))}acsc(e){return this.toDegrees(Math.asin(1/e))}asec(e){return this.toDegrees(Math.acos(1/e))}toRadians(e){return e*Math.PI/180}toDegrees(e){return e*180/Math.PI}constructor(){this.setMaxFramesPerSecond(24),o.addEventListener("mousemove",e=>{this.mouseX=e.clientX-o.offsetLeft-o.width/2,this.mouseY=-(e.clientY-o.offsetTop-o.height/2)}),o.addEventListener("mousedown",e=>{this.mouseDown=!0}),o.addEventListener("mouseup",e=>{this.mouseDown=!1}),o.addEventListener("click",e=>{this.mouseClicked=!0,setTimeout(()=>this.mouseClicked=!1,0)}),addEventListener("keydown",e=>{e.repeat||this.keysPressed.add(e.key)}),addEventListener("keyup",e=>{this.keysPressed.delete(e.key)})}},k=class extends y{radA;radB;color;outlineColor;outlineWidth;getPath(){let e=new Path2D;return e.ellipse(0,0,this.radA,this.radB,0,0,Math.PI*2),e}draw(e){let s=e?a:l;s.save();let h=this.x+i.width/2,r=-this.y+i.height/2;s.translate(h,r),s.rotate(this.toRadians(this.dir));let n=this.getPath();s.fillStyle=this.color,s.strokeStyle=this.outlineColor,s.lineWidth=this.outlineWidth,s.fill(n),this.outlineWidth&&s.stroke(n),s.restore()}setRadA(e){this.radA=e,this.refresh()}setRadB(e){this.radB=e,this.refresh()}setColor(e){this.color=e,this.refresh()}constructor(e){super(e),this.radA=e?.radA??25,this.radB=e?.radB??25,this.color=e?.color??"black",this.outlineColor=e?.outlineColor??"black",this.outlineWidth=e?.outlineWidth??0,this.draw()}},F=class extends y{drawing;size;color;getPath(){return new Path2D}draw(){}up(){this.drawing=!1}down(){this.drawing=!0}stamp(t){t.draw(!0)}ereaseAll(){a.clearRect(0,0,i.width,i.height)}dot(){a.fillStyle=this.color,a.fillRect(this.x-this.size/2+i.width/2,-this.y-this.size/2+i.height/2,this.size,this.size)}drawLine(t,e){a.beginPath(),a.moveTo(t+i.width/2,-e+i.height/2),a.lineTo(this.x+i.width/2,-this.y+i.height/2),a.lineWidth=this.size,a.strokeStyle=this.color,a.stroke()}move(t){let e=this.x,s=this.y;this.x+=t*Math.sin(this.toRadians(this.dir)),this.y+=t*Math.cos(this.toRadians(this.dir)),this.drawing&&this.drawLine(e,s),this.refresh()}setX(t){let e=this.x,s=this.y;this.x=t,this.drawing&&this.drawLine(e,s),this.refresh()}setY(t){let e=this.x,s=this.y;this.y=t,this.drawing&&this.drawLine(e,s),this.refresh()}goTo(t,e){let s=this.x,h=this.y;this.x=t,this.y=e,this.drawing&&this.drawLine(s,h),this.refresh()}changeX(t){let e=this.x,s=this.y;this.x+=t,this.drawing&&this.drawLine(e,s),this.refresh()}changeY(t){let e=this.x,s=this.y;this.y+=t,this.drawing&&this.drawLine(e,s),this.refresh()}constructor(t){super(t),this.drawing=t?.drawing??!1,this.size=t?.size??5,this.color=t?.color??"black"}},z=class extends y{content;color;fontFamily;fontSize;align;baseline;font;getPath(){let t=new Path2D;l.save(),l.font=this.font;let e=l.measureText(this.content),s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return l.restore(),t.rect(-s/2,-h/2,s,h),t}draw(t){let e=t?a:l;e.save();let s=this.x+i.width/2,h=-this.y+i.height/2;e.translate(s,h),e.rotate(this.toRadians(this.dir)),e.font=this.font,e.fillStyle=this.color,e.textAlign=this.align,e.textBaseline=this.baseline,e.fillText(this.content,0,0),e.restore()}setContent(t){this.content=t,this.refresh()}setColor(t){this.color=t,this.refresh()}setFontSize(t){this.fontSize=t,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setFontFamily(t){this.fontFamily=t,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setAlign(t){this.align=t,this.refresh()}setBaseline(t){this.baseline=t,this.refresh()}constructor(t){super(t),this.content=t?.content??"",this.color=t?.color??"black",this.fontFamily=t?.fontFamily??"Arial",this.fontSize=t?.fontSize??16,this.align=t?.align??"center",this.baseline=t?.baseline??"middle",this.font=`${this.fontSize}px ${this.fontFamily}`}};class A extends k{radius;constructor(e){super(e),this.radius=e?.radius??25,this.outlineWidth=e?.outlineWidth??4,this.setRadA(this.radius),this.setRadB(this.radius)}}const S=["red","orange","yellow","lightgreen","green","lightblue","blue","pink","purple","black","gray","white"],g=m.init(),p=20,w=10,B=-i.width/2+p+w,C=-i.height/2+p+w,v=[];for(let t=0;t<S.length;t++)v.push(new A({color:S[t],radius:p,x:B+t*(p*2+w),y:C}));const f=new F;new z({content:"Made with TScratch",x:-i.width/2+5,y:i.height/2-5,align:"left",baseline:"top"}).draw();g.setLoop("main",()=>{const{mouseX:t,mouseY:e,mouseDown:s}=g;if(s){f.goTo(t,e),f.down();for(const h of v)g.isHovered(h)&&(f.color=h.color)}else f.up()});
