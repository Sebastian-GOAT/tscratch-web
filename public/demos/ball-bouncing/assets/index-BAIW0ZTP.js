(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const o of h.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(i){if(i.ep)return;i.ep=!0;const h=s(i);fetch(i.href,h)}})();var r=document.getElementById("game-window"),a=r.getContext("2d"),l=document.createElement("canvas"),y=l.getContext("2d");l.id="pen-canvas";var g=16/9,c;function R(e){c=e,r.width=g*c,r.height=c,l.width=g*c,l.height=c}r.parentElement?.insertBefore(l,r);R(500);var m=class{x;y;dir;scene;hidden;layer;refresh(){u.init().refresh()}constructor(e){this.x=e?.x??0,this.y=e?.y??0,this.dir=e?.dir??0,this.scene=e?.scene??"main",this.hidden=e?.hidden??!1,this.layer=e?.layer??0,u.init().addSprite(this)}toRadians(e){return e*Math.PI/180}toDegrees(e){return e*180/Math.PI}move(e){this.x+=e*Math.sin(this.toRadians(this.dir)),this.y+=e*Math.cos(this.toRadians(this.dir)),this.refresh()}turn(e){this.dir+=e,this.refresh()}point(e){this.dir=e,this.refresh()}setX(e){this.x=e,this.refresh()}setY(e){this.y=e,this.refresh()}goTo(e,t){this.x=e,this.y=t,this.refresh()}changeX(e){this.x+=e,this.refresh()}changeY(e){this.y+=e,this.refresh()}show(){this.hidden=!1,this.refresh()}hide(){this.hidden=!0,this.refresh()}goToLayer(e){this.layer=e,this.refresh()}changeLayer(e){this.layer+=e,this.refresh()}},u=class M{static instance;loopRunning=!1;gameLoop=null;maxFPS=24;sounds=[];mouseX=0;mouseY=0;mouseDown=!1;currentScene="main";sceneMap={};static init(){return this.instance||(this.instance=new M),this.instance}changeScene(t){this.sceneMap[t]||(this.sceneMap[t]={sprites:[],loop:null}),this.loopRunning=!1,this.currentScene=t,this.gameLoop=this.sceneMap[t].loop,this.setMaxFramesPerSecond(this.maxFPS)}setLoop(t,s){if(!this.sceneMap[t]){this.sceneMap[t]={sprites:[],loop:s},t===this.currentScene&&this.changeScene(t);return}this.sceneMap[t].loop=s,t===this.currentScene&&this.changeScene(t)}addSprite(t){let{scene:s,layer:n}=t;if(!this.sceneMap[s]){this.sceneMap[s]={sprites:[t],loop:null};return}let i=this.sceneMap[s].sprites.findIndex(h=>h.layer>n);if(i===-1){this.sceneMap[s].sprites.push(t);return}this.sceneMap[s].sprites.splice(i,0,t)}async setMaxFramesPerSecond(t){this.maxFPS=t;let s=this.gameLoop;if(s)for(this.loopRunning=!0;this.loopRunning;)await s(),await this.wait(1e3/t)}refresh(){a.clearRect(0,0,r.width,r.height),this.sceneMap[this.currentScene]?.sprites.forEach(t=>{t.hidden||t.draw()})}async wait(t){return new Promise(s=>setTimeout(s,t))}isHovered(t){let{mouseX:s,mouseY:n}=this,i=s+r.width/2,h=r.height/2-n,o=i-(t.x+r.width/2),p=h-(r.height/2-t.y),d=-this.toRadians(t.dir),w=o*Math.cos(d)-p*Math.sin(d),S=o*Math.sin(d)+p*Math.cos(d);return a.isPointInPath(t.getPath(),w,S)}playSound(t){let s=new Audio(t);return this.sounds.push(s),s.play(),s}stopSound(t){t.pause(),t.currentTime=0,this.sounds=this.sounds.filter(s=>s!==t)}stopAllSounds(){this.sounds.forEach(t=>{t.pause(),t.currentTime=0}),this.sounds=[]}pickRandom(t,s){return t>s&&([t,s]=[s,t]),Math.floor(Math.random()*(s-t+1)+t)}sin(t){return Math.sin(this.toRadians(t))}cos(t){return Math.cos(this.toRadians(t))}tan(t){return Math.tan(this.toRadians(t))}csc(t){return 1/Math.sin(this.toRadians(t))}sec(t){return 1/Math.cos(this.toRadians(t))}cot(t){return 1/Math.tan(this.toRadians(t))}asin(t){return this.toDegrees(Math.asin(t))}acos(t){return this.toDegrees(Math.acos(t))}acsc(t){return this.toDegrees(Math.asin(1/t))}asec(t){return this.toDegrees(Math.acos(1/t))}toRadians(t){return t*Math.PI/180}toDegrees(t){return t*180/Math.PI}constructor(){this.setMaxFramesPerSecond(24),r.addEventListener("mousemove",t=>{this.mouseX=t.clientX-r.offsetLeft-r.width/2,this.mouseY=-(t.clientY-r.offsetTop-r.height/2)}),r.addEventListener("mousedown",t=>{this.mouseDown=!0}),r.addEventListener("mouseup",t=>{this.mouseDown=!1})}},v=class extends m{radA;radB;color;outlineColor;outlineWidth;getPath(){let e=new Path2D;return e.ellipse(0,0,this.radA,this.radB,0,0,Math.PI*2),e}draw(e){let t=e?y:a;t.save();let s=this.x+r.width/2,n=-this.y+r.height/2;t.translate(s,n),t.rotate(this.toRadians(this.dir));let i=this.getPath();t.fillStyle=this.color,t.strokeStyle=this.outlineColor,t.lineWidth=this.outlineWidth,t.fill(i),t.stroke(i),t.restore()}setRadA(e){this.radA=e,this.refresh()}setRadB(e){this.radB=e,this.refresh()}setColor(e){this.color=e,this.refresh()}constructor(e){super(e),this.radA=e?.radA??25,this.radB=e?.radB??25,this.color=e?.color??"black",this.outlineColor=e?.outlineColor??"black",this.outlineWidth=e?.outlineWidth??0,this.draw()}},P=class extends m{content;color;fontFamily;fontSize;align;baseline;font;getPath(){let e=new Path2D;a.save(),a.font=this.font;let t=a.measureText(this.content),s=t.width,n=t.actualBoundingBoxAscent+t.actualBoundingBoxDescent;return a.restore(),e.rect(-s/2,-n/2,s,n),e}draw(e){let t=e?y:a;t.save();let s=this.x+r.width/2,n=-this.y+r.height/2;t.translate(s,n),t.rotate(this.toRadians(this.dir)),t.font=this.font,t.fillStyle=this.color,t.textAlign=this.align,t.textBaseline=this.baseline,t.fillText(this.content,0,0),t.restore()}setContent(e){this.content=e,this.refresh()}setColor(e){this.color=e,this.refresh()}setFontSize(e){this.fontSize=e,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setFontFamily(e){this.fontFamily=e,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setAlign(e){this.align=e,this.refresh()}setBaseline(e){this.baseline=e,this.refresh()}constructor(e){super(e),this.content=e?.content??"",this.color=e?.color??"black",this.fontFamily=e?.fontFamily??"Arial",this.fontSize=e?.fontSize??16,this.align=e?.align??"center",this.baseline=e?.baseline??"middle",this.font=`${this.fontSize}px ${this.fontFamily}`}};class L extends v{radius;vX;vY=0;gravity;energyLoss;containerRadius;update(){this.vY+=this.gravity,this.changeXY(this.vX,this.vY)}changeXY(t,s){const n=Math.ceil(Math.hypot(t,s));for(let i=0;i<=n;i++)if(this.changeX(t/n),this.changeY(s/n),Math.hypot(this.x,this.y)+this.radius>this.containerRadius){this.bounce();return}}bounce(){const t=Math.hypot(this.x,this.y),s=this.x/t,n=this.y/t;this.x=s*(this.containerRadius-this.radius),this.y=n*(this.containerRadius-this.radius);const i=this.vX*s+this.vY*n;this.vX=this.energyLoss*(this.vX-2*i*s),this.vY=this.energyLoss*(this.vY-2*i*n)}constructor(t){super(t),this.radius=t?.radius??25,this.setRadA(this.radius),this.setRadB(this.radius),this.vX=t?.vX??0,this.vY=t?.vY??0,this.gravity=t?.gravity??-.8,this.energyLoss=t?.energyLoss??1,this.containerRadius=t?.containerRadius??200}}const x=u.init();x.setMaxFramesPerSecond(45);const f=200,b=25;new P({content:"Made with TScratch",x:-r.width/2+5,y:r.height/2-5,align:"left",baseline:"top"});new v({radA:f,radB:f,color:"rgba(0,0,0,0)",outlineWidth:5});const F=new L({color:"red",radius:b,containerRadius:f,outlineWidth:3,y:75,vX:(Math.random()-.5)*24,gravity:-.7});x.setLoop("main",()=>F.update());
