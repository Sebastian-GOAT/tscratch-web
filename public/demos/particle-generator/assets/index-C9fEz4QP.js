(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const c of h.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(i){if(i.ep)return;i.ep=!0;const h=s(i);fetch(i.href,h)}})();var n=document.getElementById("game-window"),l=n.getContext("2d"),o=document.createElement("canvas"),w=o.getContext("2d");o.id="pen-canvas";var m=16/9,d;function L(t){d=t,n.width=m*d,n.height=d,o.width=m*d,o.height=d}n.parentElement?.insertBefore(o,n);L(500);var x=class{x;y;dir;scene;hidden;layer;refresh(){p.init().refresh()}constructor(t){this.x=t?.x??0,this.y=t?.y??0,this.dir=t?.dir??0,this.scene=t?.scene??"main",this.hidden=t?.hidden??!1,this.layer=t?.layer??0,p.init().addSprite(this)}toRadians(t){return t*Math.PI/180}toDegrees(t){return t*180/Math.PI}move(t){this.x+=t*Math.sin(this.toRadians(this.dir)),this.y+=t*Math.cos(this.toRadians(this.dir)),this.refresh()}turn(t){this.dir+=t,this.refresh()}point(t){this.dir=t,this.refresh()}setX(t){this.x=t,this.refresh()}setY(t){this.y=t,this.refresh()}goTo(t,e){this.x=t,this.y=e,this.refresh()}changeX(t){this.x+=t,this.refresh()}changeY(t){this.y+=t,this.refresh()}show(){this.hidden=!1,this.refresh()}hide(){this.hidden=!0,this.refresh()}goToLayer(t){this.layer=t,this.refresh()}changeLayer(t){this.layer+=t,this.refresh()}},p=class S{static instance;loopRunning=!1;gameLoop=null;maxFPS=24;sounds=[];mouseX=0;mouseY=0;mouseDown=!1;currentScene="main";sceneMap={};static init(){return this.instance||(this.instance=new S),this.instance}changeScene(e){this.sceneMap[e]||(this.sceneMap[e]={sprites:[],loop:null}),this.loopRunning=!1,this.currentScene=e,this.gameLoop=this.sceneMap[e].loop,this.setMaxFramesPerSecond(this.maxFPS)}setLoop(e,s){if(!this.sceneMap[e]){this.sceneMap[e]={sprites:[],loop:s},e===this.currentScene&&this.changeScene(e);return}this.sceneMap[e].loop=s,e===this.currentScene&&this.changeScene(e)}addSprite(e){let{scene:s,layer:r}=e;if(!this.sceneMap[s]){this.sceneMap[s]={sprites:[e],loop:null};return}let i=this.sceneMap[s].sprites.findIndex(h=>h.layer>r);if(i===-1){this.sceneMap[s].sprites.push(e);return}this.sceneMap[s].sprites.splice(i,0,e),this.refresh()}removeSprite(e){let{scene:s}=e;this.sceneMap[s]&&(this.sceneMap[s].sprites=this.sceneMap[s].sprites.filter(r=>r!==e),this.refresh())}async setMaxFramesPerSecond(e){this.maxFPS=e;let s=this.gameLoop;if(s)for(this.loopRunning=!0;this.loopRunning;)await s(),await this.wait(1e3/e)}refresh(){l.clearRect(0,0,n.width,n.height),this.sceneMap[this.currentScene]?.sprites.forEach(e=>{e.hidden||e.draw()})}async wait(e){return new Promise(s=>setTimeout(s,e))}isHovered(e){let{mouseX:s,mouseY:r}=this,i=s+n.width/2,h=n.height/2-r,c=i-(e.x+n.width/2),u=h-(n.height/2-e.y),f=-this.toRadians(e.dir),P=c*Math.cos(f)-u*Math.sin(f),R=c*Math.sin(f)+u*Math.cos(f);return l.isPointInPath(e.getPath(),P,R)}playSound(e){let s=new Audio(e);return this.sounds.push(s),s.play(),s}stopSound(e){e.pause(),e.currentTime=0,this.sounds=this.sounds.filter(s=>s!==e)}stopAllSounds(){this.sounds.forEach(e=>{e.pause(),e.currentTime=0}),this.sounds=[]}pickRandom(e,s){return e>s&&([e,s]=[s,e]),Math.floor(Math.random()*(s-e+1)+e)}sin(e){return Math.sin(this.toRadians(e))}cos(e){return Math.cos(this.toRadians(e))}tan(e){return Math.tan(this.toRadians(e))}csc(e){return 1/Math.sin(this.toRadians(e))}sec(e){return 1/Math.cos(this.toRadians(e))}cot(e){return 1/Math.tan(this.toRadians(e))}asin(e){return this.toDegrees(Math.asin(e))}acos(e){return this.toDegrees(Math.acos(e))}acsc(e){return this.toDegrees(Math.asin(1/e))}asec(e){return this.toDegrees(Math.acos(1/e))}toRadians(e){return e*Math.PI/180}toDegrees(e){return e*180/Math.PI}constructor(){this.setMaxFramesPerSecond(24),o.addEventListener("mousemove",e=>{this.mouseX=e.clientX-o.offsetLeft-o.width/2,this.mouseY=-(e.clientY-o.offsetTop-o.height/2)}),o.addEventListener("mousedown",e=>{this.mouseDown=!0}),o.addEventListener("mouseup",e=>{this.mouseDown=!1})}},A=class extends x{radA;radB;color;outlineColor;outlineWidth;getPath(){let t=new Path2D;return t.ellipse(0,0,this.radA,this.radB,0,0,Math.PI*2),t}draw(t){let e=t?w:l;e.save();let s=this.x+n.width/2,r=-this.y+n.height/2;e.translate(s,r),e.rotate(this.toRadians(this.dir));let i=this.getPath();e.fillStyle=this.color,e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.fill(i),this.outlineWidth&&e.stroke(i),e.restore()}setRadA(t){this.radA=t,this.refresh()}setRadB(t){this.radB=t,this.refresh()}setColor(t){this.color=t,this.refresh()}constructor(t){super(t),this.radA=t?.radA??25,this.radB=t?.radB??25,this.color=t?.color??"black",this.outlineColor=t?.outlineColor??"black",this.outlineWidth=t?.outlineWidth??0,this.draw()}},F=class extends x{content;color;fontFamily;fontSize;align;baseline;font;getPath(){let t=new Path2D;l.save(),l.font=this.font;let e=l.measureText(this.content),s=e.width,r=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return l.restore(),t.rect(-s/2,-r/2,s,r),t}draw(t){let e=t?w:l;e.save();let s=this.x+n.width/2,r=-this.y+n.height/2;e.translate(s,r),e.rotate(this.toRadians(this.dir)),e.font=this.font,e.fillStyle=this.color,e.textAlign=this.align,e.textBaseline=this.baseline,e.fillText(this.content,0,0),e.restore()}setContent(t){this.content=t,this.refresh()}setColor(t){this.color=t,this.refresh()}setFontSize(t){this.fontSize=t,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setFontFamily(t){this.fontFamily=t,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setAlign(t){this.align=t,this.refresh()}setBaseline(t){this.baseline=t,this.refresh()}constructor(t){super(t),this.content=t?.content??"",this.color=t?.color??"black",this.fontFamily=t?.fontFamily??"Arial",this.fontSize=t?.fontSize??16,this.align=t?.align??"center",this.baseline=t?.baseline??"middle",this.font=`${this.fontSize}px ${this.fontFamily}`}};class b extends A{radius;vX;vY;gravity;energyLoss;particlesArray;update(){if(this.vX*=this.energyLoss,this.vY+=this.gravity,this.changeX(this.vX),this.changeY(this.vY),this.y-this.radius<-n.height/2){const e=this.particlesArray.indexOf(this);e!==-1&&this.particlesArray.splice(e,1);const s=p.init();s.removeSprite(this),s.refresh()}}constructor(e){super(e),this.vX=e?.vX??0,this.vY=e?.vY??0,this.gravity=e?.gravity??-.8,this.energyLoss=e?.energyLoss??.9,this.radius=e?.radius??25,this.radA=this.radius,this.radB=this.radius,this.particlesArray=e?.particlesArray??[]}}const a=p.init();a.setMaxFramesPerSecond(60);const y=12,M=3,B=-.2,D=.99,g=[];let v=!1;new F({content:"Made with TScratch",x:-n.width/2+5,y:n.height/2-5,align:"left",baseline:"top"}).draw();a.setLoop("main",()=>{const{mouseDown:t}=a;if(t&&!v){const{mouseX:e,mouseY:s}=a;for(let r=0;r<y;r++){const i=r*360/y,h=a.pickRandom(0,255),c=a.pickRandom(0,255),u=a.pickRandom(0,255);g.push(new b({x:e,y:s,vX:a.cos(i)*M,vY:a.sin(i)*M,dir:i,radius:4,gravity:B,energyLoss:D,color:`rgb(${h}, ${c}, ${u})`,particlesArray:g}))}}for(const e of g)e.update();v=t});
