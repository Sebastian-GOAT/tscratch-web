(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&h(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function h(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();var i=document.getElementById("game-window"),w=i.getContext("2d"),u=document.createElement("canvas"),a=u.getContext("2d");u.id="pen-canvas";var y=16/9,d;function L(s){d=s,i.width=y*d,i.height=d,u.width=y*d,u.height=d}i.parentElement?.insertBefore(u,i);L(500);var S=class{x;y;dir;scene;hidden;layer;refresh(){g.init().refresh()}constructor(s){this.x=s?.x??0,this.y=s?.y??0,this.dir=s?.dir??0,this.scene=s?.scene??"main",this.hidden=s?.hidden??!1,this.layer=s?.layer??0,g.init().addSprite(this)}toRadians(s){return s*Math.PI/180}toDegrees(s){return s*180/Math.PI}move(s){this.x+=s*Math.sin(this.toRadians(this.dir)),this.y+=s*Math.cos(this.toRadians(this.dir)),this.refresh()}turn(s){this.dir+=s,this.refresh()}point(s){this.dir=s,this.refresh()}setX(s){this.x=s,this.refresh()}setY(s){this.y=s,this.refresh()}goTo(s,e){this.x=s,this.y=e,this.refresh()}changeX(s){this.x+=s,this.refresh()}changeY(s){this.y+=s,this.refresh()}show(){this.hidden=!1,this.refresh()}hide(){this.hidden=!0,this.refresh()}goToLayer(s){this.layer=s,this.refresh()}changeLayer(s){this.layer+=s,this.refresh()}},g=class M{static instance;loopRunning=!1;gameLoop=null;maxFPS=24;sounds=[];mouseX=0;mouseY=0;mouseDown=!1;currentScene="main";sceneMap={};static init(){return this.instance||(this.instance=new M),this.instance}changeScene(e){this.sceneMap[e]||(this.sceneMap[e]={sprites:[],loop:null}),this.loopRunning=!1,this.currentScene=e,this.gameLoop=this.sceneMap[e].loop,this.setMaxFramesPerSecond(this.maxFPS)}setLoop(e,t){if(!this.sceneMap[e]){this.sceneMap[e]={sprites:[],loop:t},e===this.currentScene&&this.changeScene(e);return}this.sceneMap[e].loop=t,e===this.currentScene&&this.changeScene(e)}addSprite(e){let{scene:t,layer:h}=e;if(!this.sceneMap[t]){this.sceneMap[t]={sprites:[e],loop:null};return}let r=this.sceneMap[t].sprites.findIndex(n=>n.layer>h);if(r===-1){this.sceneMap[t].sprites.push(e);return}this.sceneMap[t].sprites.splice(r,0,e)}async setMaxFramesPerSecond(e){this.maxFPS=e;let t=this.gameLoop;if(t)for(this.loopRunning=!0;this.loopRunning;)await t(),await this.wait(1e3/e)}refresh(){w.clearRect(0,0,i.width,i.height),this.sceneMap[this.currentScene]?.sprites.forEach(e=>{e.hidden||e.draw()})}async wait(e){return new Promise(t=>setTimeout(t,e))}isHovered(e){let{mouseX:t,mouseY:h}=this,r=t+i.width/2,n=i.height/2-h,c=r-(e.x+i.width/2),m=n-(i.height/2-e.y),l=-this.toRadians(e.dir),x=c*Math.cos(l)-m*Math.sin(l),R=c*Math.sin(l)+m*Math.cos(l);return w.isPointInPath(e.getPath(),x,R)}playSound(e){let t=new Audio(e);return this.sounds.push(t),t.play(),t}stopSound(e){e.pause(),e.currentTime=0,this.sounds=this.sounds.filter(t=>t!==e)}stopAllSounds(){this.sounds.forEach(e=>{e.pause(),e.currentTime=0}),this.sounds=[]}pickRandom(e,t){return e>t&&([e,t]=[t,e]),Math.floor(Math.random()*(t-e+1)+e)}sin(e){return Math.sin(this.toRadians(e))}cos(e){return Math.cos(this.toRadians(e))}tan(e){return Math.tan(this.toRadians(e))}csc(e){return 1/Math.sin(this.toRadians(e))}sec(e){return 1/Math.cos(this.toRadians(e))}cot(e){return 1/Math.tan(this.toRadians(e))}asin(e){return this.toDegrees(Math.asin(e))}acos(e){return this.toDegrees(Math.acos(e))}acsc(e){return this.toDegrees(Math.asin(1/e))}asec(e){return this.toDegrees(Math.acos(1/e))}toRadians(e){return e*Math.PI/180}toDegrees(e){return e*180/Math.PI}constructor(){this.setMaxFramesPerSecond(24),i.addEventListener("mousemove",e=>{this.mouseX=e.clientX-i.offsetLeft-i.width/2,this.mouseY=-(e.clientY-i.offsetTop-i.height/2)}),i.addEventListener("mousedown",e=>{this.mouseDown=!0}),i.addEventListener("mouseup",e=>{this.mouseDown=!1})}},P=class extends S{drawing;size;color;getPath(){return new Path2D}draw(){}up(){this.drawing=!1}down(){this.drawing=!0}stamp(s){s.draw(!0)}ereaseAll(){a.clearRect(0,0,i.width,i.height)}dot(){a.fillStyle=this.color,a.fillRect(this.x-this.size/2+i.width/2,-this.y-this.size/2+i.height/2,this.size,this.size)}drawLine(s,e){a.beginPath(),a.moveTo(s+i.width/2,-e+i.height/2),a.lineTo(this.x+i.width/2,-this.y+i.height/2),a.lineWidth=this.size,a.strokeStyle=this.color,a.stroke()}move(s){let e=this.x,t=this.y;this.x+=s*Math.sin(this.toRadians(this.dir)),this.y+=s*Math.cos(this.toRadians(this.dir)),this.drawing&&this.drawLine(e,t),this.refresh()}setX(s){let e=this.x,t=this.y;this.x=s,this.drawing&&this.drawLine(e,t),this.refresh()}setY(s){let e=this.x,t=this.y;this.y=s,this.drawing&&this.drawLine(e,t),this.refresh()}goTo(s,e){let t=this.x,h=this.y;this.x=s,this.y=e,this.drawing&&this.drawLine(t,h),this.refresh()}changeX(s){let e=this.x,t=this.y;this.x+=s,this.drawing&&this.drawLine(e,t),this.refresh()}changeY(s){let e=this.x,t=this.y;this.y+=s,this.drawing&&this.drawLine(e,t),this.refresh()}constructor(s){super(s),this.drawing=s?.drawing??!1,this.size=s?.size??5,this.color=s?.color??"black"}};const o=g.init(),f=100,v=o.pickRandom(-5,5),T=o.pickRandom(-5,5),D=o.pickRandom(-5,5),E=o.pickRandom(-5,5),z=s=>[o.sin(v*s)+o.cos(T*s),o.cos(D*s)-o.sin(E*s)],p=new P({size:4});I(z);function I(s){const[e,t]=s(0);p.goTo(e*f,t*f),p.down();for(let h=1;h<=360;h++){const[r,n]=s(h);p.goTo(r*f,n*f)}p.up()}
