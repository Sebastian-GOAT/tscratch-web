(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();var h=document.getElementById("game-window"),c=h.getContext("2d"),f=document.createElement("canvas"),a=f.getContext("2d");f.id="pen-canvas";var S=16/9,u;function z(e){u=e,h.width=S*u,h.height=u,f.width=S*u,f.height=u}h.parentElement?.insertBefore(f,h);z(500);var M=class{x;y;dir;scene;hidden;layer;refresh(){y.init().refresh()}constructor(e){this.x=e?.x??0,this.y=e?.y??0,this.dir=e?.dir??0,this.scene=e?.scene??"main",this.hidden=e?.hidden??!1,this.layer=e?.layer??0,y.init().addSprite(this)}toRadians(e){return e*Math.PI/180}toDegrees(e){return e*180/Math.PI}move(e){this.x+=e*Math.sin(this.toRadians(this.dir)),this.y+=e*Math.cos(this.toRadians(this.dir)),this.refresh()}turn(e){this.dir+=e,this.refresh()}point(e){this.dir=e,this.refresh()}setX(e){this.x=e,this.refresh()}setY(e){this.y=e,this.refresh()}goTo(e,t){this.x=e,this.y=t,this.refresh()}changeX(e){this.x+=e,this.refresh()}changeY(e){this.y+=e,this.refresh()}show(){this.hidden=!1,this.refresh()}hide(){this.hidden=!0,this.refresh()}goToLayer(e){this.layer=e,this.refresh()}changeLayer(e){this.layer+=e,this.refresh()}},y=class P{static instance;loopRunning=!1;gameLoop=null;maxFPS=24;sounds=[];mouseX=0;mouseY=0;mouseDown=!1;currentScene="main";sceneMap={};static init(){return this.instance||(this.instance=new P),this.instance}changeScene(t){this.sceneMap[t]||(this.sceneMap[t]={sprites:[],loop:null}),this.loopRunning=!1,this.currentScene=t,this.gameLoop=this.sceneMap[t].loop,this.setMaxFramesPerSecond(this.maxFPS)}setLoop(t,s){if(!this.sceneMap[t]){this.sceneMap[t]={sprites:[],loop:s},t===this.currentScene&&this.changeScene(t);return}this.sceneMap[t].loop=s,t===this.currentScene&&this.changeScene(t)}addSprite(t){let{scene:s,layer:r}=t;if(!this.sceneMap[s]){this.sceneMap[s]={sprites:[t],loop:null};return}let i=this.sceneMap[s].sprites.findIndex(n=>n.layer>r);if(i===-1){this.sceneMap[s].sprites.push(t);return}this.sceneMap[s].sprites.splice(i,0,t)}async setMaxFramesPerSecond(t){this.maxFPS=t;let s=this.gameLoop;if(s)for(this.loopRunning=!0;this.loopRunning;)await s(),await this.wait(1e3/t)}refresh(){c.clearRect(0,0,h.width,h.height),this.sceneMap[this.currentScene]?.sprites.forEach(t=>{t.hidden||t.draw()})}async wait(t){return new Promise(s=>setTimeout(s,t))}isHovered(t){let{mouseX:s,mouseY:r}=this,i=s+h.width/2,n=h.height/2-r,l=i-(t.x+h.width/2),d=n-(h.height/2-t.y),g=-this.toRadians(t.dir),R=l*Math.cos(g)-d*Math.sin(g),L=l*Math.sin(g)+d*Math.cos(g);return c.isPointInPath(t.getPath(),R,L)}playSound(t){let s=new Audio(t);return this.sounds.push(s),s.play(),s}stopSound(t){t.pause(),t.currentTime=0,this.sounds=this.sounds.filter(s=>s!==t)}stopAllSounds(){this.sounds.forEach(t=>{t.pause(),t.currentTime=0}),this.sounds=[]}pickRandom(t,s){return t>s&&([t,s]=[s,t]),Math.floor(Math.random()*(s-t+1)+t)}sin(t){return Math.sin(this.toRadians(t))}cos(t){return Math.cos(this.toRadians(t))}tan(t){return Math.tan(this.toRadians(t))}csc(t){return 1/Math.sin(this.toRadians(t))}sec(t){return 1/Math.cos(this.toRadians(t))}cot(t){return 1/Math.tan(this.toRadians(t))}asin(t){return this.toDegrees(Math.asin(t))}acos(t){return this.toDegrees(Math.acos(t))}acsc(t){return this.toDegrees(Math.asin(1/t))}asec(t){return this.toDegrees(Math.acos(1/t))}toRadians(t){return t*Math.PI/180}toDegrees(t){return t*180/Math.PI}constructor(){this.setMaxFramesPerSecond(24),h.addEventListener("mousemove",t=>{this.mouseX=t.clientX-h.offsetLeft-h.width/2,this.mouseY=-(t.clientY-h.offsetTop-h.height/2)}),h.addEventListener("mousedown",t=>{this.mouseDown=!0}),h.addEventListener("mouseup",t=>{this.mouseDown=!1})}},v=class extends M{sides;radius;color;outlineColor;outlineWidth;getPath(){let e=new Path2D,t=Math.PI*2/this.sides,s=this.toRadians(this.dir),r=this.radius;for(let i=0;i<this.sides;i++){let n=i*t-Math.PI/2+s,l=r*Math.cos(n),d=-r*Math.sin(n);i===0?e.moveTo(l,d):e.lineTo(l,d)}return e.closePath(),e}draw(e){let t=e?a:c;t.save();let s=this.x+h.width/2,r=-this.y+h.height/2;t.translate(s,r);let i=this.getPath();t.fillStyle=this.color,t.strokeStyle=this.outlineColor,t.lineWidth=this.outlineWidth,t.fill(i),t.stroke(i),t.restore()}setSides(e){this.sides=e,this.refresh()}setRadius(e){this.radius=e,this.refresh()}setColor(e){this.color=e,this.refresh()}constructor(e){super(e),this.sides=e?.sides??5,this.radius=e?.radius??50,this.color=e?.color??"black",this.outlineColor=e?.outlineColor??"black",this.outlineWidth=e?.outlineWidth??0,this.draw()}},F=class extends M{drawing;size;color;getPath(){return new Path2D}draw(){}up(){this.drawing=!1}down(){this.drawing=!0}stamp(e){e.draw(!0)}ereaseAll(){a.clearRect(0,0,h.width,h.height)}dot(){a.fillStyle=this.color,a.fillRect(this.x-this.size/2+h.width/2,-this.y-this.size/2+h.height/2,this.size,this.size)}drawLine(e,t){a.beginPath(),a.moveTo(e+h.width/2,-t+h.height/2),a.lineTo(this.x+h.width/2,-this.y+h.height/2),a.lineWidth=this.size,a.strokeStyle=this.color,a.stroke()}move(e){let t=this.x,s=this.y;this.x+=e*Math.sin(this.toRadians(this.dir)),this.y+=e*Math.cos(this.toRadians(this.dir)),this.drawing&&this.drawLine(t,s),this.refresh()}setX(e){let t=this.x,s=this.y;this.x=e,this.drawing&&this.drawLine(t,s),this.refresh()}setY(e){let t=this.x,s=this.y;this.y=e,this.drawing&&this.drawLine(t,s),this.refresh()}goTo(e,t){let s=this.x,r=this.y;this.x=e,this.y=t,this.drawing&&this.drawLine(s,r),this.refresh()}changeX(e){let t=this.x,s=this.y;this.x+=e,this.drawing&&this.drawLine(t,s),this.refresh()}changeY(e){let t=this.x,s=this.y;this.y+=e,this.drawing&&this.drawLine(t,s),this.refresh()}constructor(e){super(e),this.drawing=e?.drawing??!1,this.size=e?.size??5,this.color=e?.color??"black"}},T=class extends M{content;color;fontFamily;fontSize;align;baseline;font;getPath(){let e=new Path2D;c.save(),c.font=this.font;let t=c.measureText(this.content),s=t.width,r=t.actualBoundingBoxAscent+t.actualBoundingBoxDescent;return c.restore(),e.rect(-s/2,-r/2,s,r),e}draw(e){let t=e?a:c;t.save();let s=this.x+h.width/2,r=-this.y+h.height/2;t.translate(s,r),t.rotate(this.toRadians(this.dir)),t.font=this.font,t.fillStyle=this.color,t.textAlign=this.align,t.textBaseline=this.baseline,t.fillText(this.content,0,0),t.restore()}setContent(e){this.content=e,this.refresh()}setColor(e){this.color=e,this.refresh()}setFontSize(e){this.fontSize=e,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setFontFamily(e){this.fontFamily=e,this.font=`${this.fontSize}px ${this.fontFamily}`,this.refresh()}setAlign(e){this.align=e,this.refresh()}setBaseline(e){this.baseline=e,this.refresh()}constructor(e){super(e),this.content=e?.content??"",this.color=e?.color??"black",this.fontFamily=e?.fontFamily??"Arial",this.fontSize=e?.fontSize??16,this.align=e?.align??"center",this.baseline=e?.baseline??"middle",this.font=`${this.fontSize}px ${this.fontFamily}`}};const w=y.init(),x=200,b=4,m=50;new T({content:"Made with TScratch",x:-h.width/2+5,y:h.height/2-5,align:"left",baseline:"top"});const D=new F;new v({sides:3,radius:x,dir:180});const o=new v({sides:3,radius:x,color:"white",hidden:!0});p(0,x);async function p(e,t){if(e>b)return;const s=t*.5;o.setRadius(s),D.stamp(o);const r=o.x,i=o.y;await w.wait(m),o.point(0),o.move(s),await p(e+1,s),o.goTo(r,i),await w.wait(m),o.point(120),o.move(s),await p(e+1,s),o.goTo(r,i),await w.wait(m),o.point(-120),o.move(s),await p(e+1,s),o.goTo(r,i)}
